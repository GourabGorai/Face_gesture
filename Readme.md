# Face Detection System - Outstanding Koders

## Overview
This project is a complete Face Detection System built using Python, OpenCV, and Ultralytics YOLOv8. It trains a custom AI model on the WIDER FACE dataset to detect human faces and deploys this model for real-time inference using a system webcam.

**Key Features:**
* **Face Detection:** Detects human faces with high accuracy using a custom trained YOLOv8 model.
* **Hand Gesture Recognition:** Recognizes various hand gestures (e.g., Call, Dislike, Fist, Like, Ok, Peace, Stop, etc.) in real-time.
* **Dual-Model Inference:** Runs two YOLO models in parallel to detect faces and hands simultaneously without conflict.
* **Automated Data Pipeline:** Converts WIDER FACE annotations (pixel coordinates) to YOLOv8 format (normalized).
* **GPU Accelerated Training:** Uses NVIDIA CUDA to train the model efficiently on an RTX 4060.
* **Live Inference:** A real-time camera application that detects and highlights multiple faces and hand gestures instantly.

## Examples

| Face Detection | Call | Dislike | Fist |
| :---: | :---: | :---: | :---: |
| <img src="examples/face.jpg" width="150"> | <img src="examples/call.jpg" width="150"> | <img src="examples/dislike.jpg" width="150"> | <img src="examples/fist.jpg" width="150"> |

| Four | Like | Mute | Ok |
| :---: | :---: | :---: | :---: |
| <img src="examples/four.jpg" width="150"> | <img src="examples/like.jpg" width="150"> | <img src="examples/mute.jpg" width="150"> | <img src="examples/ok.jpg" width="150"> |

| One | Palm | Peace | Peace Inverted |
| :---: | :---: | :---: | :---: |
| <img src="examples/one.jpg" width="150"> | <img src="examples/palm.jpg" width="150"> | <img src="examples/peace.jpg" width="150"> | <img src="examples/peace_inverted.jpg" width="150"> |

| Rock | Stop | Three | Three2 |
| :---: | :---: | :---: | :---: |
| <img src="examples/rock.jpg" width="150"> | <img src="examples/stop.jpg" width="150"> | <img src="examples/three.jpg" width="150"> | <img src="examples/three2.jpg" width="150"> |

| Two Up | Two Up Inverted | No Gesture | |
| :---: | :---: | :---: | :---: |
| <img src="examples/two_up.jpg" width="150"> | <img src="examples/two_up_inverted.jpg" width="150"> | <img src="examples/no_gesture.jpg" width="150"> | |

---

## üìÇ Project Structure

```text
FaceDetection_System/
‚îú‚îÄ‚îÄ archive/                   # Raw WIDER FACE dataset (Extracted)
‚îÇ   ‚îú‚îÄ‚îÄ WIDER_train/
‚îÇ   ‚îú‚îÄ‚îÄ WIDER_val/
‚îÇ   ‚îî‚îÄ‚îÄ wider_face_annotations/
‚îú‚îÄ‚îÄ runs/                      # Training logs, graphs, and weights generated by YOLO
‚îú‚îÄ‚îÄ test.py                    # MAIN SCRIPT: Handles data conversion and model training
‚îú‚îÄ‚îÄ running.py                 # CAMERA SCRIPT: Runs the live detection system (Face + Gestures)
‚îú‚îÄ‚îÄ examples/                  # Example images for README
‚îú‚îÄ‚îÄ rebuild_labels.py          # UTILITY: Fixes label generation if 'Instances: 0' error occurs
‚îú‚îÄ‚îÄ final_face_model.pt        # The final trained model file (Output)
‚îú‚îÄ‚îÄ wider_face_config.yaml     # Dataset configuration file (Auto-generated)
‚îî‚îÄ‚îÄ README.md                  # Project documentation
```

‚öôÔ∏è Prerequisites & Installation
1. System Requirements
OS: Windows 10/11

Python: Version 3.10 or 3.11 (Required for PyTorch stability)

GPU: NVIDIA RTX/GTX Series (Highly Recommended for training)

2. Environment Setup (Conda)
It is recommended to use Anaconda to manage the Python environment.

Bash

# 1. Open Anaconda Prompt
# 2. Create a clean environment
conda create -n face_system python=3.11 -y

# 3. Activate the environment
conda activate face_system
3. Install Dependencies
Install the required libraries. Note the specific command for GPU support.

Bash

# 1. Install PyTorch with CUDA 12.1 support (For NVIDIA GPUs)
pip install torch torchvision torchaudio --index-url [https://download.pytorch.org/whl/cu121](https://download.pytorch.org/whl/cu121)

# 2. Install general dependencies
pip install opencv-python ultralytics pyyaml
üöÄ Phase 1: Training the Model
The test.py script handles the entire training pipeline.

Steps:

Download the WIDER FACE dataset and extract it into the archive folder.

Run the training script:

Bash

python test.py
What this script does:

System Check: Verifies if the GPU (RTX 4060) is available.

Data Conversion: Reads WIDER FACE annotations and converts them to .txt files in YOLO format.

Configuration: Auto-generates wider_face_config.yaml.

Training: Fine-tunes the yolov8n.pt base model for 10 epochs (default).

Saving: Automatically saves the best performing model as final_face_model.pt in the project root.

üì∑ Phase 2: Running the Camera System
Once training is complete and final_face_model.pt is generated, you can start the live detection.

Command:

Bash

python running.py
Usage:

A window titled "Outstanding Koders - Face Detection" will open.

The system will draw green bounding boxes around detected faces with confidence scores.

To Quit: Press Q on your keyboard.

üõ†Ô∏è Troubleshooting Guide
1. Error: "WinError 1114" or DLL Load Failed
Cause: Missing system libraries or Intel OpenMP conflict.

Fix: The code includes os.environ["KMP_DUPLICATE_LIB_OK"] = "TRUE". If this persists, reinstall the Microsoft Visual C++ Redistributable.

2. Training shows "Instances: 0"
Cause: The model cannot find the label files (.txt) corresponding to the images.

Fix: Run the rebuild utility to force-generate labels:

Bash

python rebuild_labels.py
3. "CUDA not available" / Training is slow
Cause: PyTorch is using the CPU instead of the GPU.

Fix: Verify installation by running:

Python

import torch
print(torch.cuda.is_available())
If False, reinstall PyTorch using the --index-url command listed in the Installation section.

üìù Credits
Project By: Outstanding Koders

Base Model: Ultralytics YOLOv8

Dataset: WIDER FACE (Yang et al.)

Model file name : final_face_model.pt